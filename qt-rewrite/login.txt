登录
说明 : 登录有三个接口,建议使用encodeURIComponent对密码编码或者使用POST请求,避免某些特殊字符无法解析,如#(#在 url 中会被识别为 hash,而不是 query)

不要频繁调登录接口,不然可能会被风控,登录状态还存在就不要重复调登录接口

1. 手机登录
必选参数 :
phone: 手机号码

password: 密码

可选参数 :
countrycode: 国家码，用于国外手机号登录，例如美国传入：1

md5_password: md5 加密后的密码,传入后 password 参数将失效

captcha: 验证码,使用 /captcha/sent接口传入手机号获取验证码,调用此接口传入验证码,可使用验证码登录,传入后 password 参数将失效

接口地址 : /login/cellphone

调用例子 : /login/cellphone?phone=xxx&password=yyy /login/cellphone?phone=xxx&md5_password=yyy /login/cellphone?phone=xxx&captcha=1234

2. 邮箱登录
必选参数 :

email: 163 网易邮箱

password: 密码

可选参数 :

md5_password: md5 加密后的密码,传入后 password 将失效

接口地址 : /login

调用例子 : /login?email=xxx@163.com&password=yyy

完成登录后 , 会在浏览器保存一个 Cookies 用作登录凭证 , 大部分 API 都需要用到这个 Cookies,非跨域情况请求会自动带上 Cookies,跨域情况参考调用前须知

v3.30.0 后支持手动传入 cookie,登录接口返回内容新增 cookie 字段,保存到本地后,get 请求带上?cookie=xxx (先使用 encodeURIComponent() 编码 cookie 值) 或者 post 请求 body 带上 cookie 即可,如:/user/cloud?cookie=xxx 或者

{
    ...,
    cookie:"xxx"
}
另外的cookie说明: 可以直接从浏览器中获取cookie值, 只需要其中key为MUSIC_U的数据即可 请求

GET https://example.com/search?keywords=HELLO&cookie=MUSIC_U%3Dxxxx
POST https://example.com/search?keywords=HELLO
body {
  ...,
  "cookie": "MUSIC_U=xxxx"
}
3. 二维码登录
说明: 二维码登录涉及到 3 个接口,调用务必带上时间戳,防止缓存

1. 二维码 key 生成接口
说明: 调用此接口可生成一个 key

接口地址 : /login/qr/key

2. 二维码生成接口
说明: 调用此接口传入上一个接口生成的 key 可生成二维码图片的 base64 和二维码信息,可使用 base64 展示图片,或者使用二维码信息内容自行使用第三方二维码生成库渲染二维码

必选参数: key,由第一个接口生成

可选参数: qrimg 传入后会额外返回二维码图片 base64 编码

接口地址 : /login/qr/create

调用例子 : /login/qr/create?key=xxx

3. 二维码检测扫码状态接口
说明: 轮询此接口可获取二维码扫码状态,800 为二维码过期,801 为等待扫码,802 为待确认,803 为授权登录成功(803 状态码下会返回 cookies),如扫码后返回502,则需加上noCookie参数,如&noCookie=true

必选参数: key,由第一个接口生成

接口地址 : /login/qr/check

调用例子 : /login/qr/check?key=xxx

调用可参考项目文件例子

/public/qrlogin.html (访问地址:http://localhost:3000/qrlogin.html)

/public/qrlogin-nocookie.html (访问地址:http://localhost:3000/qrlogin-nocookie.html)

3. 游客登录
说明 : 直接调用此接口, 可获取游客cookie,如果遇到其他接口未登录状态报400状态码需要验证的错误,可使用此接口获取游客cookie避免报错

接口地址 : /register/anonimous

注意
调用登录接口的速度比调用其他接口慢 , 因为登录过程调用了加密算法

刷新登录
说明 : 调用此接口 , 可刷新登录状态,返回内容包含新的cookie(不支持刷新二维码登录的cookie)

调用例子 : /login/refresh

发送验证码
说明 : 调用此接口 ,传入手机号码, 可发送验证码

必选参数 : phone: 手机号码

可选参数 : ctcode: 国家区号,默认 86 即中国

接口地址 : /captcha/sent

调用例子 : /captcha/sent?phone=13xxx

验证验证码
说明 : 调用此接口 ,传入手机号码和验证码, 可校验验证码是否正确

必选参数 : phone: 手机号码

captcha: 验证码

可选参数 :

ctcode: 国家区号,默认 86 即中国

接口地址 : /captcha/verify

调用例子 : /captcha/verify?phone=13xxx&captcha=1597

